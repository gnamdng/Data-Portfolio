---
title: 'Projet Statistique '
output:
  pdf_document: default
  html_document: default
editor_options: 
  markdown: 
    wrap: 72
---

# Projet Statistique : Le Tourisme en Turquie

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

Le Projet Statistique Multidimensionnelle a pour but d'étudier la
fréquentation touristique en Turquie. Pour cela, nous avons à
disposition le fichier " tourisme_en_Turquie.csv " afin d'étudier le
tableau de données, constitué de 165 individus et 102 variables.

Les variables semblent se structurer en 4 Groupe dont le premier groupe
est DIVEUROP qui mesure les revenues ou l'apport des différents pays de
l'Europe; le deuxiéme groupe DIVAMERIC qui mesure les revenues ou
l'apport des différents pays de l'Amerique; troisiéme groupe DIVAFRIQ
qui mesure les revenues ou l'apport des différents pays de l'Afrique; et
enfin le qutriéme groupe DIVASIE qui mesure les revenues ou l'apport des
différents pays Asiatique.

Dans chacun de ces groupes, les angles formés par les variables entre
elles sont assez petit d'ou une correlation significative (GRANDE).

Pour cela, nous ouvrons le fichier grâce à la commande read.csv de
Rstudio.

### Edition des données

Pour identifier le formatage (séparateur de champs, décimale, noms de
variables, ....),on ouvre le fichier dans un éditeur basique.

### Importation du tableau des données

```{r}
TOURISME = read.csv("https://www.math.univ-toulouse.fr/~ferraty/DATA/tourisme_en_Turquie.csv", header = TRUE, row.names = 1)
```

Nous ne prenons pas en compte la date à la première colonne, on écrit
donc row.names = 1. De même pour la première ligne, on écrit alors
header = TRUE.

```{r}
summary(TOURISME)
```

Les variables supplémentaires (totaux des différents continents et le
total de touristes) participent pas à l'interprétation des données.
Mais, ils ne sont pas pris en compte pour les axes factoriels.

Ici, les variables supplémentaires sont: TOTALEUROP, TOTREPRUS,
TOTALAMERIQUE,TOTALAFRIQUE,TOTALASIE,TOTALTOURISTES

```{r}
View(TOURISME)
```

On affiche le View afin de voir l'ensemble des données, Si on vérifie
bien, il y a bien 102 variables. Ensuite pour réaliser l'ACP, on fait
appelle à la librairie FactoMineR.

### ACP des données du tourisme en Turquie

```{r}
library(FactoMineR)
```

Pour afficher le res.pca, on écrit quanti.sup pour les colonnes 38, 52,
62, 71, 97, 102 qui représentent les différents totaux des continents:
Europe, Pays de l'ex bloc soviétique, Amérique, Afrique, Asie & Océanie.
Puis le total de touristes qui correspond à la somme de ces 5 derniers.

Grâce à notre résumé du res.pca, on remarque une décroissance rapide
jusqu'à la dimension 3. Mais également une décroissance bien plus lente
à partir de la dimension 3.

De plus L'inertie cumulée des deux premiers axes représente 66,97% de
l'inertie totale.

Cela indique donc que les deux premières dimensions sont bien plus
importants que les axes suivants. On se concentre sur les deux premiers
axes.les sorties numeriques de summary res.pca le confirme.

```{r}
res.pca = PCA(TOURISME, quanti.sup = c(38, 52, 62, 71, 97, 102), graph = F)
res.pca = PCA(TOURISME)

```

```{r}
summary(res.pca)
```

En regardant les sorties numériques (eigenvalues), on constate que le
plan principal c'est à dire les plans principaux 1 et 2 représentent
66,98% de l'inertie totale. Cela signifie que seulement 33,02% de
l'inertie totale est répartie sur les 100 autres axes factoriels

On peut donc considérer que 66,98% de l'inertie totale représentée sur
les deux premiers axes est suffisament important.

Voici nos données récapitulatives de notre ACP. Ce résumé nous fournit
l'ensemble des pourcentages d'inertie de chaque axe mais aussi les
pourcentages d'inertie cumulés.

Ce résumé se fait sur les 10 premiers individus donc (Allemagne jusqu'à
Finlande)

```{r}
summary(res.pca)
```

```{r}
options(max.print = 1000000)
```

```{r}
summary(res.pca, nbelements = Inf)
```

On peut également afficher ce résumé dans sa totalité (pas seulement les
10 premiers élements) avec nbelements.

On observe que les variables les plus corrélées sont: la Tchéquie avec
0.859, l'Azerbadjan avec 0.858, la Hongrie avec 0.904, la Pologne avec
0.864 avec l'axe factorielle 1, même si par ailleurs, on constate une
corrélation assez forte pour d'autres variables. En revanche, le résumé
des sorties numériques concernant les variales et avec la lecture des
contributions de ces variables, on voit bien que ces variables qui
contribuent le plus sur l'axe factorielle 1. Tchéquie (1.454),
Azerbadjan(1.448), Pologne(1.470), Hongrie(1.610).

Les variables les mieux représentées pour l'axe 1 sont la Hongrie
(0.818), La Pologne (0.747), La Tchéquie (0.738), et l'Azerbadjan
(0.736) etc.

Sur l'axe 2, on observe que les variables les plus correlées en valeur
absolue sont: Italie avec (0.756), Japon(0.689), Espagne(0.667) et
Pakistan(0.683) Elles sont également les variables qui contribuent le
plus avec respectivement: 3.261, 2.711 ,2.542 ,2.665. En ce qui concerne
les variables les plus représentées, on a toujours les mêmes variables
avec valeurs respectives: 0.571, 0.475, 0.445, 0.467.

Face à cette analyse on voit bien que la variable la moins representée
sur l'axe factoriel 1 est la variable SYRIE avec 0.032 de contribution
sur l'axe. Ce qui signifie que SYRIE n'a pas vraiment rapporter une
petite partie durant ces dates en terme de revenu liés aux tourismes
dans le pays TURQUE (ou ces revenus liés etaient presque inexistant face
aux revenus rapportés par les pays comme la Hongrie, Tchequie, Pologne
etc.) la valeur de sa correlation confirme.

```{r}
sort(res.pca$var$contrib[, "Dim.1"])
```

```{r}
sort(res.pca$var$contrib[, "Dim.2"])
```

Dans cette partie d'analyse avec la sortie numerique on peut egalement
lire avec la commande res.pca$var$contrib avec l'axe factoriel 2 la
variable qui contribu la plus avec l'axe factoriel 2 est la variable
Italie qui contribu la plus sur l'axe factoriel 2 avec 3.260, aprés le
Japon avec 2.71, Pakistan avec 2.665, l'Espagne avec 2.54. On constate
bien evidemment que la variable la plus représentée sur l'axe factoriel
2 est Italie avec 0.571 et aprés Pakistan avec une valeur 0.467, Bahrein
avec 0.444 etc..

Par ailleur nous constatons les variables les moins représentées sur
l'axe factoriel 2 sont Afrique de sud avec 0.001 et aprés EAU avec 0.001
aprés Roumanie avec 0.002. ces representation nous montre que ces pays
ont rapportés mais ils ont rapportés un revenu trés peu significatif lié
au tourisme chez les Turques.

```{r}
sort(res.pca$ind$contrib[, "Dim.2"])
```

ces données nous permettent de voir que les individus qui contribuent
les plus sur le plan factoriel 2 sont: 2011-08-01 avec un apport de
3.83, 2010-08-01 avec 2.49 et aprés 2012-08-01 avec 2.35, 2020-01-01
avec 2.24 etc. Par ailleur ils sont les individus les plus correlés en
valeur absolue avec l'axe factoriel 2 soient des valeurs respectives
10.525, 8.479, 8.234, 8.055 etc. C'est avec ces dates plus ou moins que
nous obtiendrons les informations sur les pays qui ont le plus apportés
dans le compte de la Turquie en matière de revenus liés au tourisme. Par
exemple en 2011-08-01 ce sont les pays situés vraiment en bas qui ont
apportés.

Les dates les plus à droite sur l'axe factoriel 1 c'est à dire beaucoup
plus correlées sur la droite de l'axe 1 ont des valeurs très grandes
avec les pays situés plus à droite et réciproquement. Et ces pays situés
à droite ont une très faible valeur de par les dates situées plus à
gauche sur l'axe factoriel gauche.

Les dates les plus en haut sur l'axe factoriel 2 c'est à dire beaucoup
plus correlées positivement en haut ont des valeurs très grande pour les
pays fortement correlés positivement avec l'axe factoriel 2 et
réciproquement. Et ces pays situés en haut n'ont presque rien rapporté
au niveau des revenus liés aux tourismes de la Turquie durant les dates
plus corrélees negativement sur l'axe factoriel 2.

### Corrélations significatives entre variables et facteurs

On peut également utiliser dimdesc afin de décrire pour chaque dimension
les variables les plus significatives.

```{r}
dimdesc(res.pca)
```

Avec cette commande on peut surtout observer les correlations des pays
et les différentes axe.

On réalise ensuite un graphique dit "éboulis des valeurs propres":

```{r}
barplot(res.pca$eig[,2], main = "Décroissance des inerties (%)", names.arg = 1:nrow(res.pca$eig))
```

```{r}
res.pca$var$coord[, "Dim.1"]
```

```{r}
plot(res.pca, choix = "ind", invisible="var", cex = 0.7)
```

```{r}
plot(res.pca, choix = "var", cex = 0.7)
```

Pour chaque axe, on sélectionne les variables les plus corrélées puis on
s'intéresse aux individus extrêmes suivant leur localisation dans le
nuage de point.

Les dates (individus) les plus à droite c'est à dire 2019-08-01 avec une
correlation de 23.885; 2019-07-01 avec 18.706; 2018-08-01 avec 17.634;
2019-09-01 avec 17.458 et 2015-08-01 avec une correlation de 15.659 etc.
durant ces dates ce sont les pays comme la Hongrie qui a une correlation
de 0.904, la Pologne avec 0.864, Tchequie avec 0.859 et Azebadjan avec
0.858 qui ont rapportés plus de revenu liés aux tourismes selon la
nationalité dans la Turque.

Contrairement à des différentes dates plus situées à gauche) comme
2020-04-01 avec une correlation negative de 13.917, 2020-05-01 avec
-13.833, 2020-06-01 avec -13.365, 2020-07-01 avec -11.171 et 2021-02-01
avec une correlation negative de 10.141 sont des dates où les différents
pays etaient presque inexistant au niveau du Tourisme sur le territoire
de la TURQUIE car durant ces périodes il n'y avait pas de revenus liés
au tourisme selon la nationalité soit par conclusion on va dire que les
différentes nationalités venait pas pour le tourisme.

On peut bien remarque, que les dates situées le plus bas tout en restant
assez proche de l'axe vertical telles que 2011-08-01 avec une
correlation negative sur le plan factoriel 2 de 10.525, 2010-08-01 avec
-8.479, 2012-08-01 avec -8.234, 2019-08-01 avec -7.953 et 2008-08-01
avec une correlation negative de 0.756 se caracterisent par les dates ou
ce sont les pays comme l'Italie avec une correlation de -0.756, le Japon
avec -0.689, l'Espagne avec -0.667 et Norvege avec -0.641 qui ont
vraiment rapportés des revenus liés aux tourismes dans le pays de la
Turque car durant ces dates les variables Italie, Japon, Espagne,
Norvege ont une valeur élévée .

Contrairement les individus (dates) situés en haut ont des valeurs trés
bases avec l'Italie, Japon, Espagne et Norvége. on peut donc voir que
durant ces dates c'est à dire 2020-01-01 avec une correlation positive
de 8.055 sur le plan factoriel 2, 2019-04-01 avec une correlation de
7.964, 2019-08-01 avec 7.744, 2019-12-01 avec 7.476, 2019-01-01 avec une
correlation de 7.144,les pays comme l'Italie, Japon, Espagne et Norvege
ne faisaient pas vraiment de tourisme dans Turque il rapporte
presqu'aucun revenu au niveau de Tourisme dans le Turque. Et durant ces
mêmes dates ce sont les nationalités des pays comme la tunisie avec une
correlation de 0.641, Bahrein avec 0.667, Pakistan avec 0.683, Yemen
avec 0.625 qui ont vraiment trop rapportés des revenus liés au tourisme
dans la Turquie.

```{r}
summary(res.pca, nbelements = nrow(TOURISME))
```

```{r}
res.pca$eig[, "percentage of variance"]
```

```{r}
res.pca$eig[, "cumulative percentage of variance"]

```
